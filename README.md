# Simple Deployer

[![npm version](https://badge.fury.io/js/simple-deployer.svg)](https://www.npmjs.com/package/simple-deployer)

Simple-deployer enables you to execute a series of commands both locally and remotely via SSH. Deploy your application, backup a database or simply get the status of your server with a simple array of commands.

### Installation

```sh
$ npm install simple-deployer --save-dev
```

### Usage

Require simple deployer
```js
const Deployer = require('simple-deployer')
```

Server configuration
```js
const config = {
      host: 'github.com',
      port: 22,
  username: 'david'
}
```

New deployer
```js
const deployer = new Deployer(config)
```

Array of commands
```js
const commands = []

// Push a local command
commands.push({
  command: 'cd ~/pictures && ls -l',
    local: true
})

// Push a remote command
commands.push({
  command: 'cd ~/server_pictures && ls -l',
})
```

Deploy
```js
deployer.deploy(commands)
```

### Server configuration

| Option | Default | Description |
| ------ | ------ | ------ |
| host | undefined | domain or ip to be used in the ssh connection |
| username | undefined | username to be used in the ssh connection |
| port | undefined | port number to be used in the ssh connection |
| privateKeyPath | ~/.ssh/id_rsa | path to the private key file to be used in the ssh connection |
| password | undefined | server user password to be used in the ssh connection  |

### Command architecture
| Option | Type | Description |
| ------ | ------ | ------ |
| header | String | If present it just print the header string and group the commands after it |
| command | String | Command to be executed |
| dynamic | function(lastResult: String, lastCode: Number): {command: String, options: Array} | Function to dynamically generate the next command based on results during the deploy |
| options| Array | Array of command options like ['-v'] |
| local | Boolean | The command must be executed locally |
| showResults | Boolean | Print the stdout generated by the command after executing it |
| message | String | Custom message to print while executing the command |
| continueOnErrorCode | Boolean | Don't stop the deploy if this command returns an error code |
